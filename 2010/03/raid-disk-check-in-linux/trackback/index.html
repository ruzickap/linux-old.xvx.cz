<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

	<title>RAID disk check in Linux | Petr's blog about Linux</title>
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - all posts" href="../../../../feed/index.html" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - all comments" href="../../../../comments/feed/index.html" />
	<link rel="pingback" href="../../../../xmlrpc.php" />

	<!-- style START -->
	<link rel="stylesheet" href="../../../../wp-content/themes/elegant-box/style.css" type="text/css" media="screen" />
		<!--[if IE]>
		<link rel="stylesheet" href="http://linux.xvx.cz/wp-content/themes/elegant-box/ie.css" type="text/css" media="screen" />
	<![endif]-->

	<!-- default style -->
			<link rel="stylesheet" href="../../../../wp-content/themes/elegant-box/styles/blue/default.css" type="text/css" media="screen" title="blue" />
		<link rel="stylesheet" href="../../../../wp-content/themes/elegant-box/styles/blue/global.css" type="text/css" media="screen" />
	
	<!-- others styles -->
	<!-- style END -->

	<!-- javascript START -->
		<script type="text/javascript" src="../../../../wp-content/themes/elegant-box/js/base.js"></script>
	<script type="text/javascript" src="../../../../wp-content/themes/elegant-box/js/menu.js"></script>
	<!-- javascript END -->

		
			<script type="text/javascript">//<![CDATA[
			// Google Analytics for WordPress by Yoast v4.2.5 | http://yoast.com/wordpress/google-analytics/
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-6594742-3']);
							_gaq.push(['_trackPageview']);
			(function () {
				var ga = document.createElement('script');
				ga.type = 'text/javascript';
				ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(ga, s);
			})();
			//]]></script>
			<link rel="alternate" type="application/rss+xml" title="Petr&#039;s blog about Linux &raquo; RAID disk check in Linux Comments Feed" href="../feed/index.html" />
<link rel='stylesheet' id='gdsr_style_main-css'  href='http://linux.xvx.cz/wp-content/plugins/gd-star-rating/css/gdsr.css.php?t=1347955026&#038;s=a10i10m20k20c05r05%23121620243046%23121620243240%23s1pchristmas%23s1pcrystal%23s1pdarkness%23s1poxygen%23s1goxygen_gif%23s1pplain%23s1ppumpkin%23s1psoft%23s1pstarrating%23s1pstarscape%23t1pclassical%23t1pstarrating%23t1gstarrating_gif%23lsgflower%23lsgarrows&#038;o=off&#038;ver=1.9.20' type='text/css' media='all' />
<link rel='stylesheet' id='NextGEN-css'  href='../../../../wp-content/plugins/nextgen-gallery/css/nggallery.css?ver=1.0.0' type='text/css' media='screen' />
<link rel='stylesheet' id='shutter-css'  href='../../../../wp-content/plugins/nextgen-gallery/shutter/shutter-reloaded.css?ver=1.3.4' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-polls-css'  href='../../../../wp-content/themes/elegant-box/polls-css.css?ver=2.63' type='text/css' media='all' />
<link rel='stylesheet' id='codecolorer-css'  href='../../../../wp-content/plugins/codecolorer/codecolorer.css?ver=0.9.9' type='text/css' media='screen' />
<link rel='stylesheet' id='wp_dlmp_styles-css'  href='../../../../wp-content/plugins/download-monitor/page-addon/styles.css?ver=3.5.1' type='text/css' media='all' />
<script type='text/javascript' src='http://linux.xvx.cz/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/gd-star-rating/js/gdsr.js?ver=1.9.20'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var shutterSettings = {"msgLoading":"L O A D I N G","msgClose":"Click to Close","imageCount":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/nextgen-gallery/shutter/shutter-reloaded.js?ver=1.3.3'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/nextgen-gallery/js/jquery.cycle.all.min.js?ver=2.9995'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/nextgen-gallery/js/ngg.slideshow.min.js?ver=1.06'></script>
<script type='text/javascript' src='http://linux.xvx.cz/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://linux.xvx.cz/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Perl Oracle client manual installation to home directory in Debian' href='../../perl-oracle-client-manual-installation-to-home-directory-in-debian/trackback/index.html' />
<link rel='next' title='Using Grub2 and LUA installed on USB booting ISO images' href='../../using-grub2-and-lua-installed-on-usb-booting-iso-images-2/trackback/index.html' />
<meta name="generator" content="WordPress 3.5.1" />
<link rel='shortlink' href='http://wp.me/pqpDz-56' />

<!-- All in One SEO Pack 1.6.15 by Michael Torbert of Semper Fi Web Design[343,412] -->
<meta name="description" content="One day I checked dmesg from one of my servers and I saw I/O errors :-( gate:~ dmesg ... ide: failed opcode was: unknown" />
<meta name="keywords" content="raid, disk, check, linux" />
<link rel="canonical" href="index.html" />
<!-- /all in one seo pack -->
	<style type='text/css'>
	.download-info .download-button {
		background-image: url(../../../../wp-content/plugins/download-monitor/page-addon/downloadbutton.gif);
	}
	.download-info .more-button {
		background-image: url(../../../../wp-content/plugins/download-monitor/page-addon/morebutton.gif);
	}
	</style>
<link rel="shortcut icon" href="http://www.xvx.cz/favicon.ico" /><script type="text/javascript">
//<![CDATA[
var gdsr_cnst_nonce = "31f6af320f";
var gdsr_cnst_ajax = "http://linux.xvx.cz/wp-content/plugins/gd-star-rating/ajax.php";
var gdsr_cnst_button = 1;
var gdsr_cnst_cache = 0;
// ]]>
</script>
<!--[if IE]><style type="text/css">.ratemulti .starsbar .gdcurrent { -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=70)"; filter: alpha(opacity=70); }</style><![endif]-->
<!-- <meta name="NextGEN" version="1.9.6" /> -->
<style type="text/css">
.wp-polls .pollbar {
	margin: 1px;
	font-size: 6px;
	line-height: 8px;
	height: 8px;
	background-image: url('../../../../wp-content/plugins/wp-polls/images/default/pollbg.gif');
	border: 1px solid #c8c8c8;
}
</style>

<!-- Start Of Script Generated By WP-PostViews -->
<script type="text/javascript">
/* <![CDATA[ */
jQuery.ajax({type:'GET',url:'http://linux.xvx.cz/wp-admin/admin-ajax.php',data:'postviews_id=316&action=postviews',cache:false});/* ]]> */
</script>
<!-- End Of Script Generated By WP-PostViews -->

<!-- Protected by WP-SpamFree v2.1.1.2 :: JS BEGIN -->
<script type="text/javascript" src="../../../../wp-content/plugins/wp-spamfree/js/wpsf-js.php"></script> 
<!-- Protected by WP-SpamFree v2.1.1.2 :: JS END -->

<link id='MediaRSS' rel='alternate' type='application/rss+xml' title='NextGEN Gallery RSS Feed' href='../../../../wp-content/plugins/nextgen-gallery/xml/media-rss.php' />
<script type="text/javascript">
//<![CDATA[
	var screen_res = ""; 
	function writeCookie(name,value,hours) {
		var the_cookie = name+"="+escape(value)+"; expires=";
		var expires = "";
		hours=hours+0; //convert to number
		if (hours > 0) { //0==expires on browser close
			var cdate = new Date();
			cdate.setTime(cdate.getTime()+(hours*60*60*1000));
			expires = expires+cdate.toGMTString();
		} 
		document.cookie = the_cookie+expires+"; path=/; domain=";
	}
	screen_res = screen.width+" x "+screen.height;
	if (screen_res==" x ") screen_res = window.screen.width+" x "+window.screen.height;
	if (screen_res==" x ") screen_res = screen.availWidth+" x "+screen.availHeight;
	if (screen_res!=" x ") { 
		writeCookie("wassup_screen_res",screen_res,"48"); //keep 2 days
	} else {
		screen_res = "";
	}
//]]>
</script>
</head>


<body>
	<!-- header START -->
	<div id="header">
		<div class="inner">
			<div class="content">
				<div class="caption">
					<h1 id="title"><a href="../../../../index.html" title="My personal blog about Linux and other opensource applications.">Petr&#8217;s blog about Linux</a></h1>
					<div id="tagline">My personal blog about Linux and other opensource applications.</div>
				</div>

				<!-- search box -->
									<form action="../../../../index.html" id="search_box" method="get">
						<div id="searchbox">
							<input type="text" id="searchtxt" class="textfield" name="s" value="" />
						</div>
					</form>
				<script type="text/javascript">
//<![CDATA[
	var searchbox = document.getElementById("searchbox");
	var searchtxt = document.getElementById("searchtxt");
	var tiptext = "Type text to search here...";
	if(searchtxt.value == "" || searchtxt.value == tiptext) {
		searchtxt.className += " searchtip";
		searchtxt.value = tiptext;
	}
	searchtxt.onfocus = function(e) {
		if(searchtxt.value == tiptext) {
			searchtxt.value = "";
			searchtxt.className = searchtxt.className.replace(" searchtip", "");
		}
	}
	searchtxt.onblur = function(e) {
		if(searchtxt.value == "") {
			searchtxt.className += " searchtip";
			searchtxt.value = tiptext;
		}
	}
//]]>
</script>

				<!-- navigation START -->
				<ul id="navigation">

					<li class="page_item"><a href="../../../../index.html">Home</a></li>
					<li class="page_item page-item-2"><a href="../../../../about/index.html">About</a></li>
					<li id="subscribe">
						<a rel="external nofollow" title="Subscribe to this blog..." id="feed" href="../../../../feed/index.html"><img src="../../../../wp-content/themes/elegant-box/images/transparent.gif" alt="RSS feed" /></a>
													<ul>
								<li class="first"><a rel="external nofollow" title="Subscribe with Youdao" href="http://reader.youdao.com/b.do?url=http://linux.xvx.cz/feed/"> Youdao</a></li>
								<li><a rel="external nofollow" title="Subscribe with Xian Guo" href="http://www.xianguo.com/subscribe.php?url=http://linux.xvx.cz/feed/"> Xian Guo</a></li>
								<li><a rel="external nofollow" title="Subscribe with Zhua Xia" href="http://www.zhuaxia.com/add_channel.php?url=http://linux.xvx.cz/feed/"> Zhua Xia</a></li>
								<li><a rel="external nofollow" title="Subscribe with Google" href="http://fusion.google.com/add?feedurl=http://linux.xvx.cz/feed/"> Google</a></li>
								<li><a rel="external nofollow" title="Subscribe with My Yahoo!" href="http://add.my.yahoo.com/rss?url=http://linux.xvx.cz/feed/"> My Yahoo!</a></li>
								<li><a rel="external nofollow" title="Subscribe with newsgator" href="http://www.newsgator.com/ngs/subscriber/subfext.aspx?url=http://linux.xvx.cz/feed/"> newsgator</a></li>
								<li><a rel="external nofollow" title="Subscribe with Bloglines" href="http://www.bloglines.com/sub/http://linux.xvx.cz/feed/"> Bloglines</a></li>
								<li><a rel="external nofollow" title="Subscribe with iNezha" href="http://inezha.com/add?url=http://linux.xvx.cz/feed/"> iNezha</a></li>
							</ul>
											</li>

				</ul>
				<!-- navigation END -->

			</div>
		</div>
	</div>
	<!-- header END -->

	<div id="container">
		<div id="content">
			<div id="main">

		
			<div class="post">
				<div class="title">
					<h2>RAID disk check in Linux</h2>
					<div class="fixed"></div>
				</div>

				<div class="info">
					
					<span>March 23rd, 2010</span>
																<span> | Tags: <a href="../../../../tag/bad-blocks/index.html" rel="tag">bad blocks</a>, <a href="../../../../tag/check/index.html" rel="tag">check</a>, <a href="../../../../tag/disk/index.html" rel="tag">disk</a>, <a href="../../../../tag/linux/index.html" rel="tag">Linux</a>, <a href="../../../../tag/raid/index.html" rel="tag">RAID</a>, <a href="../../../../tag/read-error/index.html" rel="tag">read error</a>, <a href="../../../../tag/smartctl/index.html" rel="tag">smartctl</a></span>
					
					<div class="fixed"></div>
				</div>

				<div class="content">
					<p>One day I checked <a href="http://en.wikipedia.org/wiki/Dmesg" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org']);">dmesg</a> from one of my servers and I saw <a href="http://en.wikipedia.org/wiki/I/O" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org']);">I/O</a> errors <img src='http://linux.xvx.cz/wp-includes/images/smilies/icon_sad.gif' alt=':-(' class='wp-smiley' /> </p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ <span class="kw2">dmesg</span><br />
...<br />
<span class="br0">&#91;</span> <span class="nu0">4220.798665</span><span class="br0">&#93;</span> ide: failed opcode was: unknown &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />
<span class="br0">&#91;</span> <span class="nu0">4220.798665</span><span class="br0">&#93;</span> end_request: I<span class="sy0">/</span>O error, dev hda, sector <span class="nu0">21067462</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
<span class="br0">&#91;</span> <span class="nu0">4222.983683</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">status</span>=0x51 <span class="br0">&#123;</span> DriveReady SeekComplete Error <span class="br0">&#125;</span><br />
<span class="br0">&#91;</span> <span class="nu0">4222.983683</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">21067572</span>, <span class="re2">sector</span>=<span class="nu0">21067470</span><br />
...</div></div>
<p>Lucky for me there are two disks in <a href="http://en.wikipedia.org/wiki/Raid_1#RAID_1" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org']);">RAID 1</a> so my data was not lost. The machine is &#8220;just&#8221; firewall, so I decided to play little bit with the bad hard disk, because there are no important data on it. Usually if you see errors like I mentioned above you replace disk without any questions, but I would like to &#8220;get&#8221; some outputs from diagnostic commands. So you can see what you can do in such case.</p>
<p><span id="more-316"></span></p>
<h2>S.M.A.R.T checks</h2>
<p>The drives are pretty old, so it&#8217;s better to check if they support <a href="http://en.wikipedia.org/wiki/S.M.A.R.T." onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org']);">S.M.A.R.T.</a> and if it&#8217;s enabled:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">-i</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st_h">'SMART support'</span><br />
SMART support is: Available - device has SMART capability.<br />
SMART support is: Enabled</div></div>
<p>Let&#8217;s check some information about the disk. You can see &#8211; it&#8217;s quite old:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;height:300px;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">--attributes</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
=== START OF READ SMART DATA SECTION ===<br />
SMART Attributes Data Structure revision number: <span class="nu0">16</span><br />
Vendor Specific SMART Attributes with Thresholds: &nbsp;<br />
<span class="co4">ID# </span>ATTRIBUTE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FLAG &nbsp; &nbsp; VALUE WORST THRESH TYPE &nbsp; &nbsp; &nbsp;UPDATED &nbsp;WHEN_FAILED RAW_VALUE<br />
&nbsp; <span class="nu0">3</span> Spin_Up_Time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0027 &nbsp; <span class="nu0">235</span> &nbsp; <span class="nu0">234</span> &nbsp; 063 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">5039</span> &nbsp; &nbsp; <br />
&nbsp; <span class="nu0">4</span> Start_Stop_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">969</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; <span class="nu0">5</span> Reallocated_Sector_Ct &nbsp; 0x0033 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">251</span> &nbsp; 063 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">2</span> &nbsp; &nbsp; &nbsp; &nbsp;<br />
&nbsp; <span class="nu0">6</span> Read_Channel_Margin &nbsp; &nbsp; 0x0001 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">100</span> &nbsp; &nbsp;Pre-fail &nbsp;Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span> &nbsp; &nbsp; &nbsp; &nbsp;<br />
&nbsp; <span class="nu0">7</span> Seek_Error_Rate &nbsp; &nbsp; &nbsp; &nbsp; 0x000a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span> &nbsp; &nbsp; &nbsp; &nbsp;<br />
&nbsp; <span class="nu0">8</span> Seek_Time_Performance &nbsp; 0x0027 &nbsp; <span class="nu0">247</span> &nbsp; <span class="nu0">231</span> &nbsp; <span class="nu0">187</span> &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">33044</span><br />
&nbsp; <span class="nu0">9</span> Power_On_Minutes &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; <span class="nu0">247</span> &nbsp; <span class="nu0">247</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 148h+27m<br />
&nbsp;<span class="nu0">10</span> Spin_Retry_Count &nbsp; &nbsp; &nbsp; &nbsp;0x002b &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; <span class="nu0">223</span> &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
&nbsp;<span class="nu0">11</span> Calibration_Retry_Count 0x002b &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; <span class="nu0">223</span> &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
&nbsp;<span class="nu0">12</span> Power_Cycle_Count &nbsp; &nbsp; &nbsp; 0x0032 &nbsp; <span class="nu0">251</span> &nbsp; <span class="nu0">251</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">973</span><br />
<span class="nu0">192</span> Power-Off_Retract_Count 0x0032 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">842</span><br />
<span class="nu0">193</span> Load_Cycle_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">3829</span><br />
<span class="nu0">194</span> Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x0032 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">195</span> Hardware_ECC_Recovered &nbsp;0x000a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">248</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">6580</span><br />
<span class="nu0">196</span> Reallocated_Event_Count 0x0008 &nbsp; <span class="nu0">240</span> &nbsp; <span class="nu0">240</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">13</span><br />
<span class="nu0">197</span> Current_Pending_Sector &nbsp;0x0008 &nbsp; <span class="nu0">251</span> &nbsp; <span class="nu0">247</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">2</span><br />
<span class="nu0">198</span> Offline_Uncorrectable &nbsp; 0x0008 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">242</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">199</span> UDMA_CRC_Error_Count &nbsp; &nbsp;0x0008 &nbsp; <span class="nu0">199</span> &nbsp; <span class="nu0">199</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">200</span> Multi_Zone_Error_Rate &nbsp; 0x000a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">201</span> Soft_Read_Error_Rate &nbsp; &nbsp;0x000a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">218</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">2</span><br />
<span class="nu0">202</span> TA_Increase_Count &nbsp; &nbsp; &nbsp; 0x000a &nbsp; <span class="nu0">253</span> &nbsp; 001 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">203</span> Run_Out_Cancel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x000b &nbsp; <span class="nu0">253</span> &nbsp; 096 &nbsp; <span class="nu0">180</span> &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; In_the_past <span class="nu0">382</span><br />
<span class="nu0">204</span> Shock_Count_Write_Opern 0x000a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">151</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">205</span> Shock_Rate_Write_Opern &nbsp;0x000a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">207</span> Spin_High_Current &nbsp; &nbsp; &nbsp; 0x002a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">208</span> Spin_Buzz &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x002a &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">252</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">209</span> Offline_Seek_Performnce 0x0024 &nbsp; <span class="nu0">189</span> &nbsp; <span class="nu0">182</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
&nbsp;<span class="nu0">99</span> Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x0004 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">100</span> Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x0004 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span><br />
<span class="nu0">101</span> Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x0004 &nbsp; <span class="nu0">253</span> &nbsp; <span class="nu0">253</span> &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; <span class="nu0">0</span></div></div>
<p>The basic S.M.A.R.T. test shows there is a problem on the disk:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">--health</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
=== START OF READ SMART DATA SECTION ===<br />
SMART overall-health self-assessment <span class="kw3">test</span> result: PASSED<br />
Please note the following marginal Attributes:<br />
<span class="co4">ID# </span>ATTRIBUTE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FLAG &nbsp; &nbsp; VALUE WORST THRESH TYPE &nbsp; &nbsp; &nbsp;UPDATED &nbsp;WHEN_FAILED RAW_VALUE<br />
<span class="nu0">203</span> Run_Out_Cancel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x000b &nbsp; <span class="nu0">253</span> &nbsp; 096 &nbsp; <span class="nu0">180</span> &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; In_the_past <span class="nu0">24</span></div></div>
<p>Let&#8217;s run the &#8220;short&#8221; test to do quick test of the disk:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">-t</span> short <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===<br />
Sending command: <span class="st0">&quot;Execute SMART Short self-test routine immediately in off-line mode&quot;</span>.<br />
Drive <span class="kw3">command</span> <span class="st0">&quot;Execute SMART Short self-test routine immediately in off-line mode&quot;</span> successful.<br />
Testing has begun.<br />
Please <span class="kw3">wait</span> <span class="nu0">2</span> minutes <span class="kw1">for</span> <span class="kw3">test</span> to complete.<br />
Test will <span class="kw3">complete</span> after Thu Mar <span class="nu0">18</span> <span class="nu0">13</span>:<span class="nu0">10</span>:<span class="nu0">57</span> <span class="nu0">2010</span><br />
<br />
Use smartctl <span class="re5">-X</span> to abort test.</div></div>
<p>Here are the results from the previous test:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;height:300px;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">-l</span> selftest <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
=== START OF READ SMART DATA SECTION ===<br />
SMART Self-test log structure revision number <span class="nu0">1</span><br />
Num &nbsp;Test_Description &nbsp; &nbsp;Status &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Remaining &nbsp;LifeTime<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> &nbsp;LBA_of_first_error<br />
<span class="co0"># 1 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 2 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 3 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 4 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 5 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 6 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 7 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 8 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 9 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#10 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#11 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#12 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#13 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#14 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#15 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#16 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#17 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#18 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#19 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#20 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#21 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span></div></div>
<p>Looks like short test doesn&#8217;t tell much about errors. Run &#8220;long&#8221; one:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">-t</span> long <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===<br />
Sending command: <span class="st0">&quot;Execute SMART Extended self-test routine immediately in off-line mode&quot;</span>.<br />
Drive <span class="kw3">command</span> <span class="st0">&quot;Execute SMART Extended self-test routine immediately in off-line mode&quot;</span> successful.<br />
Testing has begun.<br />
Please <span class="kw3">wait</span> <span class="nu0">13</span> minutes <span class="kw1">for</span> <span class="kw3">test</span> to complete.<br />
Test will <span class="kw3">complete</span> after Thu Mar <span class="nu0">18</span> <span class="nu0">13</span>:<span class="nu0">24</span>:<span class="nu0">25</span> <span class="nu0">2010</span><br />
<br />
Use smartctl <span class="re5">-X</span> to abort test.</div></div>
<p>The &#8220;long&#8221; test shows the errors:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;height:300px;"><div class="bash codecolorer">gate:~ smartctl <span class="re5">-l</span> selftest <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
=== START OF READ SMART DATA SECTION ===<br />
SMART Self-test log structure revision number <span class="nu0">1</span><br />
Num &nbsp;Test_Description &nbsp; &nbsp;Status &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Remaining &nbsp;LifeTime<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> &nbsp;LBA_of_first_error<br />
<span class="co0"># 1 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed: read failure &nbsp; &nbsp; &nbsp; 60% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; 12678904</span><br />
<span class="co0"># 2 &nbsp;Extended offline &nbsp; &nbsp;Completed: read failure &nbsp; &nbsp; &nbsp; 30% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; 12678904</span><br />
<span class="co0"># 3 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed: read failure &nbsp; &nbsp; &nbsp; 60% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; 12678901</span><br />
<span class="co0"># 4 &nbsp;Extended offline &nbsp; &nbsp;Completed: read failure &nbsp; &nbsp; &nbsp; 30% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; 12678904</span><br />
<span class="co0"># 5 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 6 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 7 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 8 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0"># 9 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#10 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#11 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#12 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#13 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#14 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#15 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#16 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#17 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#18 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#19 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#20 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span><br />
<span class="co0">#21 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp; 469 &nbsp; &nbsp; &nbsp; &nbsp; -</span></div></div>
<p>See all previous errors:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ &nbsp;smartctl <span class="re5">--attributes</span> <span class="re5">--log</span>=selftest <span class="re5">--quietmode</span>=errorsonly <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
<span class="co4">ID# </span>ATTRIBUTE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FLAG &nbsp; &nbsp; VALUE WORST THRESH TYPE &nbsp; &nbsp; &nbsp;UPDATED &nbsp;WHEN_FAILED RAW_VALUE<br />
<span class="nu0">203</span> Run_Out_Cancel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x000b &nbsp; <span class="nu0">253</span> &nbsp; 096 &nbsp; <span class="nu0">180</span> &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; In_the_past <span class="nu0">66</span><br />
<br />
Num &nbsp;Test_Description &nbsp; &nbsp;Status &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Remaining &nbsp;LifeTime<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> &nbsp;LBA_of_first_error<br />
<span class="co0"># 1 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Completed: read failure &nbsp; &nbsp; &nbsp; 60% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; 12678901</span><br />
<span class="co0"># 2 &nbsp;Extended offline &nbsp; &nbsp;Completed: read failure &nbsp; &nbsp; &nbsp; 30% &nbsp; &nbsp; &nbsp;2187 &nbsp; &nbsp; &nbsp; &nbsp; 12678904</span><br />
<br />
gate:~ &nbsp;smartctl <span class="re5">--log</span>=error <span class="re5">--quietmode</span>=errorsonly <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
ATA Error Count: <span class="nu0">2105</span> <span class="br0">&#40;</span>device log contains only the most recent five errors<span class="br0">&#41;</span><br />
Error <span class="nu0">2105</span> occurred at disk power-on lifetime: <span class="nu0">2188</span> hours <span class="br0">&#40;</span><span class="nu0">91</span> days + <span class="nu0">4</span> hours<span class="br0">&#41;</span><br />
Error <span class="nu0">2104</span> occurred at disk power-on lifetime: <span class="nu0">2188</span> hours <span class="br0">&#40;</span><span class="nu0">91</span> days + <span class="nu0">4</span> hours<span class="br0">&#41;</span><br />
Error <span class="nu0">2103</span> occurred at disk power-on lifetime: <span class="nu0">2188</span> hours <span class="br0">&#40;</span><span class="nu0">91</span> days + <span class="nu0">4</span> hours<span class="br0">&#41;</span><br />
Error <span class="nu0">2102</span> occurred at disk power-on lifetime: <span class="nu0">2188</span> hours <span class="br0">&#40;</span><span class="nu0">91</span> days + <span class="nu0">4</span> hours<span class="br0">&#41;</span><br />
Error <span class="nu0">2101</span> occurred at disk power-on lifetime: <span class="nu0">2188</span> hours <span class="br0">&#40;</span><span class="nu0">91</span> days + <span class="nu0">4</span> hours<span class="br0">&#41;</span></div></div>
<h2>Bad block test</h2>
<p>You can see the errors also in the syslog:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ <span class="kw2">grep</span> LBA <span class="sy0">/</span>var<span class="sy0">/</span>log<span class="sy0">/</span>messages<br />
...<br />
Mar <span class="nu0">18</span> 08:<span class="nu0">34</span>:01 gate kernel: <span class="br0">&#91;</span> &nbsp; <span class="nu0">74.222868</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">4518804</span>, <span class="re2">sector</span>=<span class="nu0">4518798</span><br />
Mar <span class="nu0">18</span> 08:<span class="nu0">35</span>:08 gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">198.366248</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">16327415</span>, <span class="re2">sector</span>=<span class="nu0">16327414</span><br />
Mar <span class="nu0">18</span> 08:<span class="nu0">35</span>:<span class="nu0">10</span> gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">200.543912</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">16327415</span>, <span class="re2">sector</span>=<span class="nu0">16327414</span><br />
Mar <span class="nu0">18</span> 08:<span class="nu0">36</span>:<span class="nu0">18</span> gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">268.565562</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">16298535</span>, <span class="re2">sector</span>=<span class="nu0">16298534</span><br />
Mar <span class="nu0">18</span> 08:<span class="nu0">36</span>:<span class="nu0">20</span> gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">270.662356</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">16298535</span>, <span class="re2">sector</span>=<span class="nu0">16298534</span><br />
Mar <span class="nu0">18</span> 08:<span class="nu0">37</span>:<span class="nu0">15</span> gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">325.463500</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x01 <span class="br0">&#123;</span> AddrMarkNotFound <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">16285168</span>, <span class="re2">sector</span>=<span class="nu0">16285166</span> &nbsp;<br />
Mar <span class="nu0">18</span> 08:<span class="nu0">37</span>:<span class="nu0">44</span> gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">354.873957</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">3503880</span>, <span class="re2">sector</span>=<span class="nu0">3503878</span> &nbsp;<br />
Mar <span class="nu0">18</span> 08:<span class="nu0">37</span>:<span class="nu0">49</span> gate kernel: <span class="br0">&#91;</span> &nbsp;<span class="nu0">359.932012</span><span class="br0">&#93;</span> hda: dma_intr: <span class="re2">error</span>=0x40 <span class="br0">&#123;</span> UncorrectableError <span class="br0">&#125;</span>, <span class="re2">LBAsect</span>=<span class="nu0">3503880</span>, <span class="re2">sector</span>=<span class="nu0">3503878</span> &nbsp;<br />
...</div></div>
<p>Use badblock check as the last, because it&#8217;s time consuming:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ <span class="kw1">time</span> badblocks <span class="re5">-s</span> <span class="re5">-v</span> <span class="re5">-o</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>bad_blocks <span class="sy0">/</span>dev<span class="sy0">/</span>hda<br />
Checking blocks <span class="nu0">0</span> to <span class="nu0">19938239</span><br />
Checking <span class="kw1">for</span> bad blocks <span class="br0">&#40;</span>read-only <span class="kw3">test</span><span class="br0">&#41;</span>: <span class="kw1">done</span><br />
Pass completed, <span class="nu0">5</span> bad blocks found.<br />
<br />
real &nbsp; &nbsp;163m59.908s<br />
user &nbsp; &nbsp;0m3.712s<br />
sys &nbsp; &nbsp; 0m48.583s<br />
<br />
gate:~ <span class="kw2">cat</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>bad_blocks<br />
<span class="nu0">6601216</span><br />
<span class="nu0">6601592</span><br />
<span class="nu0">8043696</span><br />
<span class="nu0">8149160</span><br />
<span class="nu0">10533408</span></div></div>
<p><a href="http://en.wikipedia.org/wiki/Badblocks" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org']);">badblocks</a> and S.M.A.R.T show errors so it&#8217;s pretty clear, that that disk needs to be replaced asap.<br />
The commands I used before tested disk from &#8220;hardware&#8221; level. Because there is a RAID 1 in place it was nice opportunity to see what was happening on &#8220;software&#8221; level.</p>
<h2>RAID checks</h2>
<p>Here is the fdisk output for both disks:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ fdisk <span class="re5">-l</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda <span class="sy0">/</span>dev<span class="sy0">/</span>hdc<br />
<br />
Disk <span class="sy0">/</span>dev<span class="sy0">/</span>hda: <span class="nu0">20.4</span> GB, <span class="nu0">20416757760</span> bytes<br />
<span class="nu0">255</span> heads, <span class="nu0">63</span> sectors<span class="sy0">/</span>track, <span class="nu0">2482</span> cylinders<br />
Units = cylinders of <span class="nu0">16065</span> <span class="sy0">*</span> <span class="nu0">512</span> = <span class="nu0">8225280</span> bytes<br />
Disk identifier: 0x00051324<br />
<br />
&nbsp; &nbsp;Device Boot &nbsp; &nbsp; &nbsp;Start &nbsp; &nbsp; &nbsp; &nbsp; End &nbsp; &nbsp; &nbsp;Blocks &nbsp; Id &nbsp;System<br />
<span class="sy0">/</span>dev<span class="sy0">/</span>hda1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="nu0">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="nu0">6</span> &nbsp; &nbsp; &nbsp; <span class="nu0">48163</span>+ &nbsp;fd &nbsp;Linux raid autodetect<br />
<span class="sy0">/</span>dev<span class="sy0">/</span>hda2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="nu0">7</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="nu0">2482</span> &nbsp; &nbsp;<span class="nu0">19888470</span> &nbsp; fd &nbsp;Linux raid autodetect<br />
<br />
Disk <span class="sy0">/</span>dev<span class="sy0">/</span>hdc: <span class="nu0">20.4</span> GB, <span class="nu0">20416757760</span> bytes<br />
<span class="nu0">255</span> heads, <span class="nu0">63</span> sectors<span class="sy0">/</span>track, <span class="nu0">2482</span> cylinders<br />
Units = cylinders of <span class="nu0">16065</span> <span class="sy0">*</span> <span class="nu0">512</span> = <span class="nu0">8225280</span> bytes<br />
Disk identifier: 0x0006e1d1<br />
<br />
&nbsp; &nbsp;Device Boot &nbsp; &nbsp; &nbsp;Start &nbsp; &nbsp; &nbsp; &nbsp; End &nbsp; &nbsp; &nbsp;Blocks &nbsp; Id &nbsp;System<br />
<span class="sy0">/</span>dev<span class="sy0">/</span>hdc1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="nu0">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="nu0">6</span> &nbsp; &nbsp; &nbsp; <span class="nu0">48163</span>+ &nbsp;fd &nbsp;Linux raid autodetect<br />
<span class="sy0">/</span>dev<span class="sy0">/</span>hdc2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="nu0">7</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="nu0">2482</span> &nbsp; &nbsp;<span class="nu0">19888470</span> &nbsp; fd &nbsp;Linux raid autodetect</div></div>
<p>Before I began to do any high disk utilization operations, it was good to check used max speed for RAID check. If I had this value &#8220;higher&#8221; it could really slow down the server. 1 MB/s is enough for my old disks:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ <span class="kw3">echo</span> <span class="nu0">1000</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>proc<span class="sy0">/</span>sys<span class="sy0">/</span>dev<span class="sy0">/</span>raid<span class="sy0">/</span>speed_limit_max<br />
gate:~ <span class="kw2">cat</span> <span class="sy0">/</span>etc<span class="sy0">/</span>sysctl.conf<br />
...<br />
<span class="co0"># RAID rebuild min/max speed K/Sec per device</span><br />
dev.raid.speed_limit_min = <span class="nu0">100</span><br />
dev.raid.speed_limit_max = <span class="nu0">1000</span></div></div>
<p>Start disk check:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;height:300px;"><div class="bash codecolorer">gate:~ <span class="sy0">/</span>usr<span class="sy0">/</span>share<span class="sy0">/</span>mdadm<span class="sy0">/</span>checkarray <span class="re5">--all</span><br />
checkarray: I: check queued <span class="kw1">for</span> array md0.<br />
checkarray: I: check queued <span class="kw1">for</span> array md1.<br />
<br />
gate:~ <span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>mdstat<br />
Personalities : <span class="br0">&#91;</span>raid1<span class="br0">&#93;</span><br />
md1 : active raid1 hda2<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> hdc2<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span class="nu0">19888384</span> blocks <span class="br0">&#91;</span><span class="nu0">2</span><span class="sy0">/</span><span class="nu0">2</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>UU<span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="re2">resync</span>=DELAYED<br />
<br />
md0 : active raid1 hda1<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> hdc1<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span class="nu0">48064</span> blocks <span class="br0">&#91;</span><span class="nu0">2</span><span class="sy0">/</span><span class="nu0">2</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>UU<span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span class="br0">&#91;</span>======<span class="sy0">&gt;</span>..............<span class="br0">&#93;</span> &nbsp;check = <span class="nu0">31.9</span><span class="sy0">%</span> <span class="br0">&#40;</span><span class="nu0">16000</span><span class="sy0">/</span><span class="nu0">48064</span><span class="br0">&#41;</span> <span class="re2">finish</span>=0.4min <span class="re2">speed</span>=1066K<span class="sy0">/</span>sec<br />
<br />
unused devices: <span class="sy0">&lt;</span>none<span class="sy0">&gt;</span><br />
<br />
gate:~ <span class="kw2">dmesg</span><br />
...<br />
<span class="br0">&#91;</span><span class="nu0">41674.362333</span><span class="br0">&#93;</span> md: data-check of RAID array md0<br />
<span class="br0">&#91;</span><span class="nu0">41674.362399</span><span class="br0">&#93;</span> md: minimum _guaranteed_ &nbsp;speed: <span class="nu0">100</span> KB<span class="sy0">/</span>sec<span class="sy0">/</span>disk.<br />
<span class="br0">&#91;</span><span class="nu0">41674.362447</span><span class="br0">&#93;</span> md: using maximum available idle IO bandwidth <span class="br0">&#40;</span>but not <span class="kw2">more</span> than <span class="nu0">1000</span> KB<span class="sy0">/</span>sec<span class="br0">&#41;</span> <span class="kw1">for</span> data-check.<br />
<span class="br0">&#91;</span><span class="nu0">41674.362532</span><span class="br0">&#93;</span> md: using 128k window, over a total of <span class="nu0">48064</span> blocks.<br />
<span class="br0">&#91;</span><span class="nu0">41674.385200</span><span class="br0">&#93;</span> md: delaying data-check of md1 <span class="kw1">until</span> md0 has finished <span class="br0">&#40;</span>they share one or <span class="kw2">more</span> physical units<span class="br0">&#41;</span><br />
<span class="br0">&#91;</span><span class="nu0">41721.793276</span><span class="br0">&#93;</span> md: md0: data-check done.<br />
<span class="br0">&#91;</span><span class="nu0">41721.851857</span><span class="br0">&#93;</span> md: data-check of RAID array md1<br />
<span class="br0">&#91;</span><span class="nu0">41721.852088</span><span class="br0">&#93;</span> md: minimum _guaranteed_ &nbsp;speed: <span class="nu0">100</span> KB<span class="sy0">/</span>sec<span class="sy0">/</span>disk.<br />
<span class="br0">&#91;</span><span class="nu0">41721.852140</span><span class="br0">&#93;</span> md: using maximum available idle IO bandwidth <span class="br0">&#40;</span>but not <span class="kw2">more</span> than <span class="nu0">1000</span> KB<span class="sy0">/</span>sec<span class="br0">&#41;</span> <span class="kw1">for</span> data-check.<br />
<span class="br0">&#91;</span><span class="nu0">41721.852226</span><span class="br0">&#93;</span> md: using 128k window, over a total of <span class="nu0">19888384</span> blocks.<br />
<span class="br0">&#91;</span><span class="nu0">41721.856334</span><span class="br0">&#93;</span> RAID1 conf printout:<br />
<span class="br0">&#91;</span><span class="nu0">41721.856395</span><span class="br0">&#93;</span> &nbsp;<span class="re5">---</span> wd:<span class="nu0">2</span> rd:<span class="nu0">2</span><br />
<span class="br0">&#91;</span><span class="nu0">41721.856439</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">0</span>, wo:<span class="nu0">0</span>, o:<span class="nu0">1</span>, dev:hda1<br />
<span class="br0">&#91;</span><span class="nu0">41721.856484</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">1</span>, wo:<span class="nu0">0</span>, o:<span class="nu0">1</span>, dev:hdc1<br />
<span class="br0">&#91;</span><span class="nu0">65191.893316</span><span class="br0">&#93;</span> md: md1: data-check done.<br />
<span class="br0">&#91;</span><span class="nu0">65192.158680</span><span class="br0">&#93;</span> RAID1 conf printout:<br />
<span class="br0">&#91;</span><span class="nu0">65192.158745</span><span class="br0">&#93;</span> &nbsp;<span class="re5">---</span> wd:<span class="nu0">2</span> rd:<span class="nu0">2</span><br />
<span class="br0">&#91;</span><span class="nu0">65192.158787</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">0</span>, wo:<span class="nu0">0</span>, o:<span class="nu0">1</span>, dev:hda2<br />
<span class="br0">&#91;</span><span class="nu0">65192.158829</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">1</span>, wo:<span class="nu0">0</span>, o:<span class="nu0">1</span>, dev:hdc2<br />
...<br />
<span class="sy0">&lt;/</span>none<span class="sy0">&gt;</span></div></div>
<p>To my surprise mdadm didn&#8217;t find any errors <img src='http://linux.xvx.cz/wp-includes/images/smilies/icon_sad.gif' alt=':-(' class='wp-smiley' /> </p>
<h2>Disk replacement</h2>
<p>The disk needed to be replaced by the new one.<br />
First I had to mark it as failed:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ mdadm <span class="re5">--manage</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md0 <span class="re5">--fail</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda1<br />
mdadm: <span class="kw1">set</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda1 faulty <span class="kw1">in</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md0<br />
gate:~ <span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>mdstat<br />
Personalities : <span class="br0">&#91;</span>raid1<span class="br0">&#93;</span><br />
md1 : active raid1 hda2<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> hdc2<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span class="nu0">19888384</span> blocks <span class="br0">&#91;</span><span class="nu0">2</span><span class="sy0">/</span><span class="nu0">2</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>UU<span class="br0">&#93;</span><br />
<br />
md0 : active raid1 hda1<span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="br0">&#40;</span>F<span class="br0">&#41;</span> hdc1<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span class="nu0">48064</span> blocks <span class="br0">&#91;</span><span class="nu0">2</span><span class="sy0">/</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>_U<span class="br0">&#93;</span><br />
<br />
unused devices: <span class="sy0">&lt;</span>none<span class="sy0">&gt;</span><br />
<span class="sy0">&lt;/</span>none<span class="sy0">&gt;</span></div></div>
<p>Then I removed it from /dev/md0:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ mdadm <span class="re5">--manage</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md0 <span class="re5">--remove</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda1<br />
mdadm: hot removed <span class="sy0">/</span>dev<span class="sy0">/</span>hda1</div></div>
<p>Dmesg:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ <span class="kw2">dmesg</span><br />
...<br />
<span class="br0">&#91;</span><span class="nu0">142783.600283</span><span class="br0">&#93;</span> raid1: Disk failure on hda1, disabling device.<br />
<span class="br0">&#91;</span><span class="nu0">142783.600294</span><span class="br0">&#93;</span> raid1: Operation continuing on <span class="nu0">1</span> devices.<br />
<span class="br0">&#91;</span><span class="nu0">142783.624888</span><span class="br0">&#93;</span> RAID1 conf printout:<br />
<span class="br0">&#91;</span><span class="nu0">142783.624947</span><span class="br0">&#93;</span> &nbsp;<span class="re5">---</span> wd:<span class="nu0">1</span> rd:<span class="nu0">2</span><br />
<span class="br0">&#91;</span><span class="nu0">142783.624986</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">0</span>, wo:<span class="nu0">1</span>, o:<span class="nu0">0</span>, dev:hda1<br />
<span class="br0">&#91;</span><span class="nu0">142783.625029</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">1</span>, wo:<span class="nu0">0</span>, o:<span class="nu0">1</span>, dev:hdc1<br />
<span class="br0">&#91;</span><span class="nu0">142783.636136</span><span class="br0">&#93;</span> RAID1 conf printout:<br />
<span class="br0">&#91;</span><span class="nu0">142783.636203</span><span class="br0">&#93;</span> &nbsp;<span class="re5">---</span> wd:<span class="nu0">1</span> rd:<span class="nu0">2</span><br />
<span class="br0">&#91;</span><span class="nu0">142783.636245</span><span class="br0">&#93;</span> &nbsp;disk <span class="nu0">1</span>, wo:<span class="nu0">0</span>, o:<span class="nu0">1</span>, dev:hdc1<br />
<span class="br0">&#91;</span><span class="nu0">142905.796896</span><span class="br0">&#93;</span> md: unbind<span class="sy0">&lt;</span>hda1<span class="sy0">&gt;</span><br />
<span class="br0">&#91;</span><span class="nu0">142905.796988</span><span class="br0">&#93;</span> md: export_rdev<span class="br0">&#40;</span>hda1<span class="br0">&#41;</span><br />
...<br />
<span class="sy0">&lt;/</span>hda1<span class="sy0">&gt;</span></div></div>
<p>I had to do the same procedure for md1:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ mdadm <span class="re5">--manage</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md1 <span class="re5">--fail</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda2<br />
mdadm: <span class="kw1">set</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda2 faulty <span class="kw1">in</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md1<br />
gate:~ mdadm <span class="re5">--manage</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md1 <span class="re5">--remove</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda2<br />
mdadm: hot removed <span class="sy0">/</span>dev<span class="sy0">/</span>hda2</div></div>
<p>Warning email from mdadm was sent:</p>
<div class="codecolorer-container email default" style="overflow:auto;white-space:nowrap;"><div class="email codecolorer"><span class="sc0"><span class="kw3">Subject</span><span class="sy0">:</span> Fail event on /dev/md0<span class="sy0">:</span>gate</span><br />
<br />
This is an automatically generated mail message from mdadm<br />
running on gate<br />
<br />
A Fail event had been detected on md device /dev/md0.<br />
<br />
It could be related to component device /dev/hda1.</div></div>
<h2>After disk change</h2>
<p>New disk was installed, OS was up and running &#8211; it&#8217;s time to check bad sectors on the new one:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ <span class="kw1">time</span> badblocks <span class="re5">-s</span> <span class="re5">-v</span> <span class="re5">-w</span> <span class="re5">-o</span> <span class="sy0">/</span>var<span class="sy0">/</span>tmp<span class="sy0">/</span>bad_blocks <span class="sy0">/</span>dev<span class="sy0">/</span>hda</div></div>
<p>I needed to have the same partitions like on the new &#8220;clean&#8221; disk like on the old one. The easiest way is to use sfdisk:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ sfdisk <span class="re5">-d</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hdc <span class="sy0">|</span> sfdisk <span class="re5">--force</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda</div></div>
<p>Added the partitions to the RAID:</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ mdadm <span class="re5">--manage</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md0 <span class="re5">--add</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda1<br />
gate:~ mdadm <span class="re5">--manage</span> <span class="sy0">/</span>dev<span class="sy0">/</span>md1 <span class="re5">--add</span> <span class="sy0">/</span>dev<span class="sy0">/</span>hda2</div></div>
<p>The last step is installing the GRUB to MBR of the new disk. If you forgot about it, than I will not be able to boot from the &#8220;new&#8221; (hda) disk if &#8220;old&#8221; disk (hdc) fail.</p>
<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;"><div class="bash codecolorer">gate:~ grub<br />
root <span class="br0">&#40;</span>hd0,<span class="nu0">0</span><span class="br0">&#41;</span><br />
setup <span class="br0">&#40;</span>hd0<span class="br0">&#41;</span></div></div>
<p>You find fine a lot of great tips regarding &#8220;bad sectors&#8221; on this page <a href="http://smartmontools.sourceforge.net/badblockhowto.html" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://smartmontools.sourceforge.net']);">http://smartmontools.sourceforge.net/badblockhowto.html</a>.</p>
<div style="display: none">VN:F [1.9.20_1166]</div><div class="ratingblock "><div class="ratingheader "></div><div class="ratingstars "><div id="article_rater_316" class="ratepost gdsr-crystal gdsr-size-20"><div class="starsbar gdsr-size-20"><div class="gdouter gdheight"><div id="gdr_vote_a316" style="width: 184px;" class="gdinner gdheight"></div><div id="gdr_stars_a316" class="gdsr_rating_as"><a id="gdsrX316X10X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="10 / 10" class="s10" rel="nofollow"></a><a id="gdsrX316X9X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="9 / 10" class="s9" rel="nofollow"></a><a id="gdsrX316X8X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="8 / 10" class="s8" rel="nofollow"></a><a id="gdsrX316X7X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="7 / 10" class="s7" rel="nofollow"></a><a id="gdsrX316X6X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="6 / 10" class="s6" rel="nofollow"></a><a id="gdsrX316X5X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="5 / 10" class="s5" rel="nofollow"></a><a id="gdsrX316X4X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="4 / 10" class="s4" rel="nofollow"></a><a id="gdsrX316X3X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="3 / 10" class="s3" rel="nofollow"></a><a id="gdsrX316X2X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="2 / 10" class="s2" rel="nofollow"></a><a id="gdsrX316X1X0XaXarticle_rater_316Xarticle_loader_316X10X20" title="1 / 10" class="s1" rel="nofollow"></a></div></div></div></div><div id="article_loader_316" style="display: none; width: 200px " class="ratingloaderarticle"><div class="loader arrows " style="height: 20px"><div class="loaderinner">please wait...</div></div></div></div><div class="ratingtext "><div id="gdr_text_a316">Rating: 9.2/<strong>10</strong> (5 votes cast)</div></div></div><span class="hreview-aggregate" style="display: none !important;"><span class="item"><span class="fn">RAID disk check in Linux</span></span>, <span class="rating"><span class="average">9.2</span> out of <span class="best">10</span> based on <span class="votes">5</span> ratings <span class="summary"></span></span></span>					<div class="fixed"></div>
				</div>

				<div class="comments comments_single">
					<a href="index.html#respond">Leave a comment</a>
											 | <a href="index.html" rel="trackback">Trackback</a>
									</div>

				<!-- related posts START -->
								<!-- related posts END -->
			</div>


<script type="text/javascript" src="../../../../wp-content/themes/elegant-box/js/comment.js"></script>

	<div class="messagebox">
		<div class="content small">
			No comments yet.		</div>
	</div>


	<div id="respond">
	<form action="http://linux.xvx.cz/wp-comments-post.php" method="post" id="commentform">

	<!-- comment info -->
	<div id="comment_header">
		<div id="comment_info">
							
				<div id="author_info">
					<div class="row">
						<input type="text" name="author" id="author" class="textfield" value="" size="24" tabindex="1" />
						<label for="author" class="small">Name (required)</label>
					</div>
					<div class="row">
						<input type="text" name="email" id="email" class="textfield" value="" size="24" tabindex="2" />
						<label for="email" class="small">E-Mail (will not be published) (required)</label>
					</div>
					<div class="row">
						<input type="text" name="url" id="url" class="textfield" value="" size="24" tabindex="3" />
						<label for="url" class="small">Website</label>
					</div>
				</div>

				
					</div>
	</div>

	<!-- comment input -->
	<textarea name="comment" id="comment" tabindex="4" rows="8" cols="50"></textarea>

	<!-- comment submit and rss -->
	<div id="submitbox">
		<div id="comments_rss">
			<a href="../../../../comments/feed/index.html">
				<span class="feed">Subscribe to comments feed</span>
			</a>
		</div>

		<div class="act">
							<a rel="nofollow" id="cancel-comment-reply-link" href="index.html#respond" style="display:none;">Cancel</a>						<input name="submit" type="submit" id="submit" class="button" tabindex="5" value="Submit Comment" />
		</div>
		
		<input type="hidden" name="comment_post_ID" value="316" />
					<input type='hidden' name='comment_post_ID' value='316' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
				<div class="fixed"></div>
	</div>

		<script type='text/javascript'>
	<!--
	refJS = escape( document[ 'referrer' ] );
	document.write("<input type='hidden' name='refJS' value='"+refJS+"'>");
	// -->
	</script>
	<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8219fbb15a" /></p>	</form>
	</div>

	

			

	</div>

	<!-- sidebar START -->
<div id="sidebar">

<!-- Style Switcher START -->
<!-- Style Switcher END -->

		<!-- showcase -->
		
		<ul id="widgets">

<li class="widget widget_archive"><h3>Archives</h3>		<ul>
			<li><a href='../../../../2013/06/index.html' title='June 2013'>June 2013</a>&nbsp;(1)</li>
	<li><a href='../../../../2012/01/index.html' title='January 2012'>January 2012</a>&nbsp;(1)</li>
	<li><a href='../../../../2011/12/index.html' title='December 2011'>December 2011</a>&nbsp;(1)</li>
	<li><a href='../../../../2011/02/index.html' title='February 2011'>February 2011</a>&nbsp;(1)</li>
	<li><a href='../../../../2011/01/index.html' title='January 2011'>January 2011</a>&nbsp;(1)</li>
	<li><a href='../../../12/index.html' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='../../../09/index.html' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='../../../05/index.html' title='May 2010'>May 2010</a>&nbsp;(1)</li>
	<li><a href='../../../04/index.html' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='../../index.html' title='March 2010'>March 2010</a>&nbsp;(5)</li>
	<li><a href='../../../../2009/12/index.html' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='../../../../2009/08/index.html' title='August 2009'>August 2009</a>&nbsp;(1)</li>
	<li><a href='../../../../2009/06/index.html' title='June 2009'>June 2009</a>&nbsp;(3)</li>
	<li><a href='../../../../2009/03/index.html' title='March 2009'>March 2009</a>&nbsp;(3)</li>
	<li><a href='../../../../2009/02/index.html' title='February 2009'>February 2009</a>&nbsp;(1)</li>
		</ul>
</li><li class="widget widget_polls-widget"><h3>Polls</h3><div id="polls-2" class="wp-polls">
	<form id="polls_form_2" class="wp-polls-form" action="index.html" method="post">
		<p style="display: none;"><input type="hidden" id="poll_2_nonce" name="wp-polls-nonce" value="72cec8fd98" /></p>
		<p style="display: none;"><input type="hidden" name="poll_id" value="2" /></p>
		<p style="display: none;"><input type="hidden" id="poll_multiple_ans_2" name="poll_multiple_ans_2" value="3" /></p>
		<p style="text-align: center;"><strong>Favourite distro</strong></p><div id="polls-2-ans" class="wp-polls-ans"><ul class="wp-polls-ul">
		<li><input type="checkbox" id="poll-answer-6" name="poll_2" value="6" /> <label for="poll-answer-6">Debian, Ubuntu</label></li>
		<li><input type="checkbox" id="poll-answer-7" name="poll_2" value="7" /> <label for="poll-answer-7">RedHat, Fedora, CentOS</label></li>
		<li><input type="checkbox" id="poll-answer-8" name="poll_2" value="8" /> <label for="poll-answer-8">Gentoo, Sabayon</label></li>
		<li><input type="checkbox" id="poll-answer-9" name="poll_2" value="9" /> <label for="poll-answer-9">Arch</label></li>
		<li><input type="checkbox" id="poll-answer-10" name="poll_2" value="10" /> <label for="poll-answer-10">Slackware</label></li>
		<li><input type="checkbox" id="poll-answer-11" name="poll_2" value="11" /> <label for="poll-answer-11">openSUSE</label></li>
		<li><input type="checkbox" id="poll-answer-12" name="poll_2" value="12" /> <label for="poll-answer-12">Mandriva</label></li>
		</ul><p style="text-align: center;"><input type="button" name="vote" value="   Vote   " class="Buttons" onclick="poll_vote(2);" onkeypress="poll_result(2);" /></p><p style="text-align: center;"><a href="index.html#ViewPollResults" onclick="poll_result(2); return false;" onkeypress="poll_result(2); return false;" title="View Results Of This Poll">View Results</a></p></div>
	</form>
</div>
<div id="polls-2-loading" class="wp-polls-loading"><img src="../../../../wp-content/plugins/wp-polls/images/loading.gif" width="16" height="16" alt="Loading ..." title="Loading ..." class="wp-polls-image" />&nbsp;Loading ...</div>
</li><li class="widget wassup_widget"><h3>Visitors Online</h3><ul class='links'><li><strong style='padding:0 4px 0 4px;background:#ddd;color:#777'>05</strong> visitor(s) online</li><li style='font-size:6pt; color:#bbb;'>powered by <a style='color:#777;' href='http://www.wpwp.org' title='WassUp - Real Time Visitors Tracking'>WassUp</a></li></ul></li>		</ul>

		<!-- showcase 2 -->
		
</div>
<!-- sidebar END -->

	<div class="fixed"></div>

		<div id="bottom">
			<div class="postnav">
				<span class="alignleft">&laquo; <a href="../../perl-oracle-client-manual-installation-to-home-directory-in-debian/trackback/index.html" rel="prev">Perl Oracle client manual installation to home directory in Debian</a></span>
				<span class="alignright"><a href="../../using-grub2-and-lua-installed-on-usb-booting-iso-images-2/trackback/index.html" rel="next">Using Grub2 and LUA installed on USB booting ISO images</a> &raquo;</span>
				<div class="fixed"></div>
			</div>

			<div class="anchor">
				<span><a href="index.html#" onclick="MGJS.goTop();return false;">TOP</a></span>
			</div>
			<div class="fixed"></div>
			</div>
		<div class="fixed"></div>
	</div>
</div>

<!-- footer START -->
<div id="footer">
	<div class="inner">
		<div class="content">
			<p id="about">
				Copyright &copy; 2009-2013 Petr&#8217;s blog about Linux | Powered by <a href="http://wordpress.org/">WordPress</a> | Theme by <a href="http://www.neoease.com/">NeoEase</a>			</p>

			<ul id="admin">
								<li><a href="../../../../wp-login.php">Log in</a></li>
			</ul>

			<div class="fixed"></div>
		</div>
	</div>
</div><!-- footer END -->
<!--[if IE]>
<script language=javascript>
//<![CDATA[
	if (screen_res=="") {
		screen_res = screen.width + " x " + screen.height;
	}
	if (screen_res!=" x ") {
		var cdate = new Date();
		cdate.setTime(cdate.getTime()+(48*60*60*1000));
		var cexpires = cdate.toGMTString();
		//var the_cookie = "wassup_screen_res="+escape(screen_res)+"; expires="+cexpires;
		document.cookie = "wassup_screen_res=" + escape(screen_res)+ "; path=/; domain=" + document.domain;

	}
//]]>
</script>
<![endif]--><!--
<p class="small"> WassUp 1.8.3.1 timestamp: 2013-06-22 10:03:36AM UTC (11:03AM)<br />
If above timestamp is not current time, this page is cached.</p> -->
<script type='text/javascript' src='http://lite.piclens.com/current/piclens_optimized.js?ver=3.5.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var pollsL10n = {"ajax_url":"http:\/\/linux.xvx.cz\/wp-admin\/admin-ajax.php","text_wait":"Your last request is still being processed. Please wait a while ...","text_valid":"Please choose a valid poll answer.","text_multiple":"Maximum number of choices allowed: ","show_loading":"1","show_fading":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/wp-polls/polls-js.js?ver=2.63'></script>
<!--stats_footer_test--><script src="http://stats.wordpress.com/e-201325.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'6295081',v:'ext',post:'316'});
var load_cmc = function(){linktracker_init(6295081,316,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script>

</body>
</html>
